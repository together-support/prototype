<!DOCTYPE html>
<html lang="en">
  <head>
    <title>UI Prototype</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- import the webpage's stylesheet -->
    <link rel="stylesheet" href="grid.css" />

    <!-- import the webpage's javascript file -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

  </head>

  <body>

    <div class="navbar">
        <div class="title">
            Togethernet
        </div>
       <div class="roomlink">
        room-title-place-holder
        </div>
    </div>

    <div class="chat"> 

        <div class = "avatar" style= "background-color:FireBrick;"></div>
        <div class = "shadow"></div>
    
    </div>

<script type="text/javascript">

// cell properties
let cellNum = parseInt(getComputedStyle(document.documentElement)
    .getPropertyValue('--cell-horizontal-num'));

// user pos
let avatarX = parseInt(getComputedStyle(document.documentElement)
    .getPropertyValue('--avatar-x'));
let avatarY = parseInt(getComputedStyle(document.documentElement)
    .getPropertyValue('--avatar-y'));

const shadow = document.querySelector('.shadow');

// user movement
$(document).keydown(function(e){
 
    var keyCode = e.keyCode || e.which;
    const scrollSpeed = 500;
 
    if (keyCode == 38) 
 { 
        avatarY--;

        if (avatarY < 1){
            avatarY = cellNum/2;    
            moveAvatar();

            $('html, body').animate({
            scrollTop: $(document).height()
            }, scrollSpeed);
        } else {
            animateAvatar();
        }
    }
 
    if (keyCode == 40) 
 { 
        avatarY++;

        if (avatarY > cellNum/2){
            avatarY = 1;    
            moveAvatar();

            $('html, body').animate({
            scrollTop: 0
            }, scrollSpeed);
        } else {
            animateAvatar();
        }
    }
 
    if (keyCode == 37) 
 { 
        avatarX--;

        if (avatarX < 2){
            avatarX = cellNum;   
            moveAvatar();

            $('html, body').animate({
            scrollLeft: $(document).width()
            }, scrollSpeed);
        } else {
            animateAvatar();
        }
    }
 
    if (keyCode == 39) 
    {

        avatarX++;

        if (avatarX > cellNum){
            avatarX = 1;   
            moveAvatar();

            $('html, body').animate({
            scrollLeft: 0
            }, scrollSpeed);
        } else {
            animateAvatar();
        }
    }

    console.log(`x:${avatarX}, y:${avatarY}`);
 
});

function animateAvatar(){
    $('.shadow').css('grid-column-start', avatarX);
    $('.shadow').css('grid-row-start', avatarY);
    $('.avatar').animate({    
        'left': shadow.offsetLeft,
        'top': shadow.offsetTop,
    });
}

function moveAvatar(){
    $('.shadow').css('grid-column-start', avatarX);
    $('.shadow').css('grid-row-start', avatarY);
    $('.avatar').css({    
        'left': shadow.offsetLeft,
        'top': shadow.offsetTop,
    });
}
 
</script> 
</body>