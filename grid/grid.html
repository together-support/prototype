<!DOCTYPE html>
<html lang="en">
  <head>
    <title>UI Prototype</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- import the webpage's stylesheet -->
    <link rel="stylesheet" href="grid.css" />

    <!-- import the webpage's javascript file -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

  </head>

  <body>

<div class="grid-container"> 
      
<div class = "avatar" style= "background-color:FireBrick;"></div>
<div class = "ghost"></div>
  
</div>

<br>

<button onclick="zoomIn()">Zoom In</button>
<button onclick="zoomOut()">Zoom Out</button>

<script type="text/javascript">

// zoom properties
let zoomStage = 0;
let zoomIncrement = 10;

// cell properties
let cellNum = parseInt(getComputedStyle(document.documentElement)
    .getPropertyValue('--cell-horizontal-num'));
let oldCellSize = parseInt(getComputedStyle(document.documentElement)
    .getPropertyValue('--cell-size'), 10);
let newCellSize = parseInt(getComputedStyle(document.documentElement)
    .getPropertyValue('--cell-size'), 10);

// user pos
let userX = parseInt(getComputedStyle(document.documentElement)
    .getPropertyValue('--user-x'));
let userY = parseInt(getComputedStyle(document.documentElement)
    .getPropertyValue('--user-y'));

const ghost = document.querySelector('.ghost');

// zooming feature
function zoomIn(){
        if (zoomStage > 0){
        zoomStage--;
        newCellSize = newCellSize + (oldCellSize / 4);
        cellNum = cellNum - zoomIncrement;
        
        document.documentElement.style.setProperty('--cell-horizontal-num', cellNum);
        document.documentElement.style.setProperty('--cell-vertical-num', cellNum/2);
        document.documentElement.style.setProperty('--cell-size', newCellSize+'vh');
        animateAvatar();
        console.log(`cell size: ${newCellSize} horizotal cell num: ${cellNum} vertical cell num: ${cellNum/2}`);
    } else {
        alert('reached minimum zoom');
    }
}

function zoomOut(){
if (zoomStage < 2){
        zoomStage++;
        newCellSize = newCellSize - (oldCellSize / 4);
        cellNum = cellNum + zoomIncrement;

        document.documentElement.style.setProperty('--cell-horizontal-num', cellNum);
        document.documentElement.style.setProperty('--cell-vertical-num', cellNum/2);
        document.documentElement.style.setProperty('--cell-size', newCellSize+'vh');
        animateAvatar();
        console.log(`cell size: ${newCellSize} horizotal cell num: ${cellNum} vertical cell num: ${cellNum/2}`);

    } else {
        alert('reached maximum zoom');
    }
}

// user movement

$(document).keydown(function(e){
 
    //e.which is set by jQuery for those browsers that do not normally support e.keyCode.
    var keyCode = e.keyCode || e.which;
 
    if (keyCode == 38) 
 { 
        userY--;

        if (userY < 1){
            userY = cellNum/2;    
             moveAvatar();
        }else {
             animateAvatar();
        }
    }
 
    if (keyCode == 40) 
 { 
        userY++;

        if (userY > cellNum/2){
            userY = 1;    
            moveAvatar();
        }else {
             animateAvatar();
        }

    }
 
    if (keyCode == 37) 
 { 
        userX--;

        if (userX < 1){
            userX = cellNum;   
              moveAvatar();
        } else {
             animateAvatar();
        }
    }
 
    if (keyCode == 39) 
    {

        userX++;

        if (userX > cellNum){
            userX = 1;   
             moveAvatar();
        } else {
               animateAvatar();
        }
    }

    console.log(`x:${userX}, y:${userY}`);
 
});

function animateAvatar(){
    $('.ghost').css('grid-column-start', userX);
    $('.ghost').css('grid-row-start', userY);
    $('.avatar').animate({    
        'left': ghost.offsetLeft,
        'top': ghost.offsetTop
    });
}

function moveAvatar(){
    $('.ghost').css('grid-column-start', userX);
    $('.ghost').css('grid-row-start', userY);
    $('.avatar').css({    
        'left': ghost.offsetLeft,
        'top': ghost.offsetTop
    });
}
 
</script> 
  </body>