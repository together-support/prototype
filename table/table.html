<!DOCTYPE html>
<html lang="en">
  <head>
    <title>UI Prototype</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- import the webpage's stylesheet -->
    <link rel="stylesheet" href="table.css" />

    <!-- import the webpage's javascript file -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

  </head>

  <body>

<table id="stage">
  <tr>
    <th id="1">1</th>
    <th id="2">2</th>
    <th id="3">3</th>
    <th id="4">4</th>
  </tr>
  <tr>
    <td headers="1"></td>
    <td headers="2"></td>
    <td headers="3"></td>
    <td headers="4"></td>
    <td headers="5"></td>

    </tr>
  <tr>
      
    <td headers="6"></td>
    <td headers="7"></td>
    <td headers="8"></td>
    <!-- <td headers="9"></td>
    <td headers="10"></td>
    <td headers="11"></td>
    <td headers="12"></td>
    <td headers="13"></td>
    <td headers="14"></td>
    <td headers="15"></td>
    <td headers="16"></td>
    <td headers="17"></td>
    <td headers="18"></td>
    <td headers="19"></td>
    <td headers="20"></td> -->
  </tr>
</table>

  <div class = "avatar" style= "background-color:FireBrick;"></div>

<br>

<button onclick="zoomIn()">Zoom In</button>
<button onclick="zoomOut()">Zoom Out</button>

<script type="text/javascript">

$(document).ready(function(){

    // FLIP: First
    let table = document.getElementById("stage"); 
    let td = table.getElementsByTagName("td")[0];

    console.log(td);

    let userPos = td.getBoundingClientRect();
    let userX = userPos.x;
    let userY = userPos.y;
    let cellX = 0;
    let cellY = 0;
    let cellHorizontalNum = 4;

    $('.avatar').css({
        'left': userX,
        'top' : userY
    });

     $(this).keydown(function(e) {
    
        var keyCode = e.keyCode || e.which;
 
    if (keyCode == 38) 
 { 
        userY--;

        if (userY < 1){
            userY = cellNum/2;    
        }

        $('.avatar').css('grid-row-start', userY);
    }
 
    if (keyCode == 40) 
 { 
        userY++;

        if (userY > cellNum/2){
            userY = 1;    
        }

        $('.avatar').css('grid-row-start', userY);
    }
 
    if (keyCode == 37) 
 { 
        cellX--;

        if (cellX < 0){
            cellX = cellHorizontalNum;  
        }
    }
 
    if (keyCode == 39) 
    {
        cellX++;

        if (cellX > cellHorizontalNum){
        cellX = 0;
        }
    }

         // LAST
        td = table.getElementsByTagName("td")[cellX];

        let destPos = td.getBoundingClientRect();
        let destX = destPos.x;
        let destY = destPos.y;

        $('.avatar').animate({    
        'left': destX,
        'top': destY
        });

        userX = destX;
        uesrY = destY;

        console.log(`cell x ${cellX}`);
        console.log(`user x:${userX}, user y:${userY}`);
        console.log(`dest x:${destX}, dest y:${destY}`);

    });
});

// // zoom properties
// let zoomStage = 0;
// let zoomIncrement = 10;

// // cell properties
// let cellNum = parseInt(getComputedStyle(document.documentElement)
//     .getPropertyValue('--cell-horizontal-num'));
// let oldCellSize = parseInt(getComputedStyle(document.documentElement)
//     .getPropertyValue('--cell-size'), 10);
// let newCellSize = parseInt(getComputedStyle(document.documentElement)
//     .getPropertyValue('--cell-size'), 10);

// // user pos
// let userX = parseInt(getComputedStyle(document.documentElement)
//     .getPropertyValue('--user-x'));
// let userY = parseInt(getComputedStyle(document.documentElement)
//     .getPropertyValue('--user-y'));

// // zooming feature
// function zoomIn(){
//         if (zoomStage > 0){
//         zoomStage--;
//         newCellSize = newCellSize + (oldCellSize / 4);
//         cellNum = cellNum - zoomIncrement;
        
//         document.documentElement.style.setProperty('--cell-horizontal-num', cellNum);
//         document.documentElement.style.setProperty('--cell-vertical-num', cellNum/2);
//         document.documentElement.style.setProperty('--cell-size', newCellSize+'vh');
        
//         console.log(`cell size: ${newCellSize} horizotal cell num: ${cellNum} vertical cell num: ${cellNum/2}`);
//     } else {
//         console.log('reached minimum zoom');
//     }
// }

// function zoomOut(){
// if (zoomStage < 2){
//         zoomStage++;
//         newCellSize = newCellSize - (oldCellSize / 4);
//         cellNum = cellNum + zoomIncrement;

//         document.documentElement.style.setProperty('--cell-horizontal-num', cellNum);
//         document.documentElement.style.setProperty('--cell-vertical-num', cellNum/2);
//         document.documentElement.style.setProperty('--cell-size', newCellSize+'vh');

//         console.log(`cell size: ${newCellSize} horizotal cell num: ${cellNum} vertical cell num: ${cellNum/2}`);

//     } else {
//         console.log('reached maximum zoom');
//     }
// }

// // user movement

// $(document).keydown(function(e){
 
//  //e.which is set by jQuery for those browsers that do not normally support e.keyCode.
//  var keyCode = e.keyCode || e.which;
 
//     if (keyCode == 38) 
//  { 
//         userY--;

//         if (userY < 1){
//             userY = cellNum/2;    
//         }

//         $('.avatar').css('grid-row-start', userY);
//     }
 
//     if (keyCode == 40) 
//  { 
//         userY++;

//         if (userY > cellNum/2){
//             userY = 1;    
//         }

//         $('.avatar').css('grid-row-start', userY);
//     }
 
//     if (keyCode == 37) 
//  { 
//         userX--;

//         if (userX < 1){
//             userX = cellNum;    
//         }

//         $('.avatar').css('grid-column-start', userX);
//     }
 
//     if (keyCode == 39) 
//     {

//         userX++;

//         if (userX > cellNum){
//             userX = 1;    
//         }

//         $('.avatar').css('grid-column-start', userX);

//         // $('.avatar').animate({    
//         // 'grid-column-start': userX
//         // });
//     }

//         console.log(`x:${userX}, y:${userY}`);
 
// });
 
</script> 
  </body>